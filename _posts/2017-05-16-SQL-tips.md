---
layout: post
title: SQL survival kit
tag: SQL
---

Here are basic queries to collect data from SQL.

## Data collecting
```SQL
SELECT * FROM DATA.TABLE;
```
## Check NULL
ISNULL, NULLIF

## Sort
TOP N / TOP N Percent: select N rows or N percentage, OFFSET, FETCH
-----
```SQL
SELECT TOP 10 Percent Name
FROM SalesLT.Product
ORDER BY Weight DESC;
```
-----
```SQL
SELECT Name
FROM SalesLT.Product
ORDER BY Weight DESC
OFFSET 10 ROWS FETCH NEXT 100 ROWS ONLY;
```
## Filtering
WHERE, DISTINCT, BETWEEN, IN, <>=, IN, AND, OR, NOT
```SQL
SELECT DISTINCT City, StateProvince
FROM SalesLT.Address;
```
-----
```SQL
SELECT ProductNumber, Name
FROM SalesLT.Product
WHERE Color IN ('Black', 'Red', 'White') AND Size IN ('S', 'M');
```
-----
```SQL
SELECT ProductNumber, Name, ListPrice
FROM SalesLT.Product
WHERE ProductNumber LIKE 'BK-[^R]%-[0-9][0-9]';
```
## Format

‘AB%’: value begin with AB string

‘%AB’: value end with AB string

‘%AB%’: value contain AB string

[^R]: different from R string

## JOIN
[INNER] JOIN: return row matched 2 tables.

[OUTER] JOIN: return all rows in one table and matching rows from other tables. LEFT/RIGHT JOINS

CROSS JOIN: returns a Cartesian product that includes every combination of the selected columns from both tables.

SELF JOIN: A self-join is an inner, outer, or cross join that matches rows in a table to other rows in the same table. When defining a self-join, you must specify an alias for at least one instance of the table being joined.

![figure_pic]({{ site.baseurl }}https://i.stack.imgur.com/hMKKt.jpg)

## UNION
- Use UNION to combine the rowsets returned by mulitple queries.

- Each unioned query must return the same number of columns with compatible data types.

- By default, UNION eliminates duplicate rows. Specify the ALL option to include duplicates (or to avoid the overhead of checking for duplicates when you know in advance that there are none).

## INTERCEPT / EXCEPT
- Use INTERSECT to return only rows that are returned by both queries.

- Use EXCEPT to return rows from the first query that are not returned by the second query.

### Scalar functions return a single value based on zero or more input parameters.
### Logical functions return Boolean values (true or false) based on an expression or column value.
### Window functions are used to rank rows across partitions or "windows". Window functions include RANK, DENSE_RANK, NTILE, and ROW_NUMBER.
### Aggregate functions are used to provide summary values for mulitple rows - for example, the total cost of products or the maximum number of items in an order. Commonly used aggregate functions include SUM, COUNT, MIN, MAX, and AVG.
### HAVING after result > < Where before result.
### You can use GROUP BY with aggregate functions to return aggregations grouped by one or more columns or expressions.
### All columns in the SELECT clause that are not aggregate function expressions must be included in a GROUP BY clause.
### The order in which columns or expressions are listed in the GROUP BY clause determines the grouping hierarchy.
### You can filter the groups that are included in the query results by specifying a HAVING clause.



