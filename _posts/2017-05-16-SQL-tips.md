---
layout: post
title: SQL survival kit
tag: SQL
---

Here are basic queries to collect data from SQL.

## Data collecting
```SQL
SELECT * FROM DATA.TABLE;
```
## Check NULL
ISNULL, NULLIF

## Sort
TOP N / TOP N Percent: select N rows or N percentage, OFFSET, FETCH
-----
```SQL
SELECT TOP 10 Percent Name
FROM SalesLT.Product
ORDER BY Weight DESC;
```
-----
```SQL
SELECT Name
FROM SalesLT.Product
ORDER BY Weight DESC
OFFSET 10 ROWS FETCH NEXT 100 ROWS ONLY;
```
## Filtering
WHERE, DISTINCT, BETWEEN, IN, <>=, IN, AND, OR, NOT
```SQL
SELECT DISTINCT City, StateProvince
FROM SalesLT.Address;
```
-----
```SQL
SELECT ProductNumber, Name
FROM SalesLT.Product
WHERE Color IN ('Black', 'Red', 'White') AND Size IN ('S', 'M');
```
-----
```SQL
SELECT ProductNumber, Name, ListPrice
FROM SalesLT.Product
WHERE ProductNumber LIKE 'BK-[^R]%-[0-9][0-9]';
```
## Format

‘AB%’: value begin with AB string

‘%AB’: value end with AB string

‘%AB%’: value contain AB string

[^R]: different from R string

## JOIN
[INNER] JOIN: return row matched 2 tables.

[OUTER] JOIN: return all rows in one table and matching rows from other tables. LEFT/RIGHT JOINS

CROSS JOIN: returns a Cartesian product that includes every combination of the selected columns from both tables.

SELF JOIN: A self-join is an inner, outer, or cross join that matches rows in a table to other rows in the same table. When defining a self-join, you must specify an alias for at least one instance of the table being joined.

![figure_pic]({{ site.baseurl }}https://i.stack.imgur.com/hMKKt.jpg)

## UNION
- Use UNION to combine the rowsets returned by mulitple queries.

- Each unioned query must return the same number of columns with compatible data types.

- By default, UNION eliminates duplicate rows. Specify the ALL option to include duplicates (or to avoid the overhead of checking for duplicates when you know in advance that there are none).

## INTERCEPT / EXCEPT
- Use INTERSECT to return only rows that are returned by both queries.

- Use EXCEPT to return rows from the first query that are not returned by the second query.
